---
title: "VOICEVOXã«Twitterã‚’èª­ã¿ä¸Šã’ã¦ã‚‚ã‚‰ã†ã€‚ã€Œã¤ã„ã‚ˆã¿ã€ã‚’é–‹ç™ºã—ã¾ã—ãŸã€‚"
emoji: "ğŸ¥•"
type: "tech"
topics:
  - "rust"
  - "è¨­è¨ˆ"
  - "éŸ³å£°åˆæˆ"
  - "ã‚„ã£ã¦ã¿ãŸ"
  - "voicevox"
published: true
published_at: "2023-02-14 20:12"
---

## ã¤ã„ã‚ˆã¿

ãƒ„ã‚¤ãƒƒã‚¿ãƒ¼ã‚’èª­ã¿ä¸Šã’ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’é–‹ç™ºã—ã¾ã—ãŸã€‚
éŸ³å£°åˆæˆã‚½ãƒ•ãƒˆã«ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã®èª­ã¿ä¸Šã’ã‚’è¡Œã‚ã›ã¾ã™ã€‚
https://booth.pm/ja/items/4503494


### å¯¾å¿œã™ã‚‹éŸ³å£°åˆæˆã‚½ãƒ•ãƒˆ

VOICEVOXä»¥å¤–ã«ã‚‚ã€VOICEVOX APIã‚’æä¾›ã™ã‚‹ä»¥ä¸‹ã®éŸ³å£°åˆæˆã‚½ãƒ•ãƒˆã«å¯¾å¿œã—ã¦ã„ã¾ã™
 - VOICEVOX
 - COEIROINK
 - LMROID
 - SHAREVOX
 - ITVOICE


### ä½¿ã„æ–¹

1. éŸ³å£°åˆæˆã‚½ãƒ•ãƒˆã‚’èµ·å‹•
2. æœ¬ã‚¢ãƒ—ãƒªã‚’èµ·å‹•
3. ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§æœ¬ã‚¢ãƒ—ãƒªã«ã‚ˆã‚‹Twitterã®ä½¿ç”¨ã‚’è¨±å¯ã™ã‚‹ã€‚


### æœ¬è¨˜äº‹ã«ã¤ã„ã¦

æœ¬è¨˜äº‹ã§ã¯ã€ã¤ã„ã‚ˆã¿ã®è¨­è¨ˆã®ãƒã‚¤ãƒ³ãƒˆã¨å¾—ã‚‰ã‚ŒãŸæŠ€è¡“çš„ãªçŸ¥è¦‹ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

## æ§‹æˆ

å…¨ä½“ã®æ§‹æˆã¯å¤§ä½“ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/483717d9c4e5-20230214.png)

éŸ³å£°ã‚’å†ç”Ÿã™ã‚‹ã¾ã§ã®æµã‚Œã¯ä»¥ä¸‹ã®é€šã‚Šã€

 1. Twitterã«Tweetã‚’è¦æ±‚
 2. Twitterã‹ã‚‰Tweetã‚’å–å¾—
 3. VOICEVOXã«Tweetã®æ–‡å­—åˆ—ã‚’é€ä¿¡
 4. VOICEVOXã‹ã‚‰éŸ³å£°ã‚’å–å¾—
 5. å–å¾—ã—ãŸéŸ³å£°ã‚’å†ç”Ÿ

## å¤–çš„è¦ç´ 

### Twitter API v2

https://developer.twitter.com/en/docs/twitter-api/tweets/timelines/api-reference/get-users-id-reverse-chronological

æœ€æ–°ã®ãƒ„ã‚¤ãƒ¼ãƒˆã‚’25ä»¶å–å¾—ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã€‚ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã®URLã‚‚å«ã‚ã¦å–å¾—ã™ã‚‹ã€‚

```rust:src-tauri/src/twitter_client.rs
    let token = "BEARER TOKEN",
    let user_id = "USER ID"
    let client = reqwest::Client::new();
    let auth_val = format!("Bearer {token}");

    let mut query = [
        ("expansions", "author_id"),
        ("user.fields", "profile_image_url"),
        ("tweet.fields", "created_at"),
        ("max_results", "25"),
    ]
    .to_vec();

    let url = format!("https://api.twitter.com/2/users/{user_id}/timelines/reverse_chronological");

    let timeline = client
        .get(url)
        .header(reqwest::header::AUTHORIZATION, auth_val)
        .query(&query)
        .send()
        .await
        .unwrap();
```

### VOICEVOX API

https://github.com/VOICEVOX/voicevox_engine#api-%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88

VOICEVOXã¯ã€å†…éƒ¨ã®ã‚¨ãƒ³ã‚¸ãƒ³éƒ¨ãŒHTTPã‚µãƒ¼ãƒã¨ã—ã¦å‹•ã„ã¦ãŠã‚Šã€HTTPçµŒç”±ã§éŸ³å£°åˆæˆã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ã¤ã„ã‚ˆã¿ã¯ã€ã“ã®APIã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§éŸ³å£°åˆæˆã‚’è¡Œã†ã€‚

1. éŸ³å£°åˆæˆã‚’è¡Œã†ãŸã‚ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
```rust:src-tauri/src/voicegen_client.rs
    let client = reqwest::Client::new();

    let url: String = "http://127.0.0.1:50021/audio_query".to_string();
    let audio_query = client
        .post(url)
        .query(&[
            ("text", text.as_str()),
            ("speaker", speaker.to_string().as_str()),
        ])
        .send()
        .await
        .unwrap()
        .text()
        .await
        .unwrap();
```

2. ç”Ÿæˆã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦éŸ³å£°ã‚’åˆæˆ
```rust:src-tauri/src/voicegen_client.rs
    let audio_query = serde_json::to_string(&audio_query).unwrap();

    let url: String = "http://127.0.0.1:50021/synthesis".to_string();
    let data = client
        .post(url)
        .query(&[("speaker", speaker.to_string().as_str())])
        .body(audio_query)
        .send()
        .await
        .unwrap()
        .bytes()
        .await
        .unwrap();
```

## è©³ç´°

å¤–çš„è¦ç´ ãŒãŸãã•ã‚“ã‚ã‚Šæ§‹æˆãŒè¤‡é›‘ãªã®ã§å†…éƒ¨ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚‚ã†å°‘ã—è©³ç´°åŒ–ã€‚
å›³ã¯DFDã§è¡¨ç¾ã€‚
![](https://storage.googleapis.com/zenn-user-upload/a371b5f38567-20230214.png)

ä¸»ã«ä»¥ä¸‹ã®ï¼“ã¤ã®ãƒ­ã‚¸ãƒƒã‚¯ãŒå¹³è¡Œã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«åˆ¶å¾¡ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
 - ãƒ„ã‚¤ãƒ¼ãƒˆã‚’å–å¾—ã™ã‚‹éƒ¨åˆ†
 - ãƒ„ã‚¤ãƒ¼ãƒˆã‚’éŸ³å£°ã«å¤‰æ›ã™ã‚‹éƒ¨åˆ†
 - éŸ³å£°ã‚’å†ç”Ÿã™ã‚‹éƒ¨åˆ†

## å®Ÿè£…

 - React Ã— Tauri

https://github.com/iwase22334/twradio


## æœ€å¾Œã«

ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã‚’èª­ã¿ä¸Šã’ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’é–‹ç™ºã—ã¾ã—ãŸã€‚å†…éƒ¨çš„ã«ã¯Twitter, VOICEVOX, ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã‚’é©åˆ‡ã«åˆ¶å¾¡ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã«ãªã£ã¦ã„ã¾ã™ã€‚